

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; smote_variants 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Adding a new oversampler" href="add_new_oversampler.html" />
    <link rel="prev" title="Multiclass oversampling" href="multiclass_oversampling.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> smote_variants
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oversamplers.html">Oversamplers</a></li>
<li class="toctree-l1"><a class="reference internal" href="noise_filters.html">Noise filters and prototype selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_selection.html">Model selection, evaluation and validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiclass_oversampling.html">Multiclass oversampling</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#simple-oversampling">Simple oversampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oversampling-with-random-reasonable-parameters">Oversampling with random, reasonable parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiclass-oversampling">Multiclass oversampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-selection">Model selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thorough-evaluation-involving-multiple-datasets">Thorough evaluation involving multiple datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reproducing-the-results-in-the-comparative-study">Reproducing the results in the comparative study</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="add_new_oversampler.html">Adding a new oversampler</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">Interfaces</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="use_in_r.html">Using <code class="docutils literal notranslate"><span class="pre">smote_variants</span></code> in R</a></li>
<li class="toctree-l1"><a class="reference internal" href="use_in_julia.html">Using <code class="docutils literal notranslate"><span class="pre">smote_variants</span></code> in Julia</a></li>
</ul>
<p class="caption"><span class="caption-text">The competition</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="competition.html">About the competition</a></li>
<li class="toctree-l1"><a class="reference internal" href="ranking.html">Ranking</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloads.html">Downloads</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_history.html">Release History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">smote_variants</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="simple-oversampling">
<h2>Simple oversampling<a class="headerlink" href="#simple-oversampling" title="Permalink to this headline">¶</a></h2>
<p>Oversampling can be carried out by importing any oversampler from the <code class="docutils literal notranslate"><span class="pre">smote_variants</span></code> package, instantiating and calling its <code class="docutils literal notranslate"><span class="pre">sample</span></code> function:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">smote_variants</span> <span class="kn">as</span> <span class="nn">sv</span>

<span class="n">oversampler</span><span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">SMOTE_ENN</span><span class="p">()</span>

<span class="c1"># supposing that X and y contain some the feature and target data of some dataset</span>
<span class="n">X_samp</span><span class="p">,</span> <span class="n">y_samp</span><span class="o">=</span> <span class="n">oversampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">datasets</span></code> package of <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> to import some data:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">smote_variants</span> <span class="kn">as</span> <span class="nn">sv</span>
<span class="kn">import</span> <span class="nn">sklearn.datasets</span> <span class="kn">as</span> <span class="nn">datasets</span>

<span class="n">dataset</span><span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">()</span>

<span class="n">oversampler</span><span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">KernelADASYN</span><span class="p">()</span>

<span class="n">X_samp</span><span class="p">,</span> <span class="n">y_samp</span><span class="o">=</span> <span class="n">oversampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Using the imbalanced datasets available in the <code class="docutils literal notranslate"><span class="pre">imbalanced_datasets</span></code> package:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">smote_variants</span> <span class="kn">as</span> <span class="nn">sv</span>
<span class="kn">import</span> <span class="nn">imbalanced_datasets</span> <span class="kn">as</span> <span class="nn">imbd</span>

<span class="n">dataset</span><span class="o">=</span> <span class="n">imbd</span><span class="o">.</span><span class="n">load_iris0</span><span class="p">()</span>

<span class="n">oversamplers</span><span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">SMOTE_OUT</span><span class="p">()</span>

<span class="n">X_samp</span><span class="p">,</span> <span class="n">y_samp</span><span class="o">=</span> <span class="n">oversampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="oversampling-with-random-reasonable-parameters">
<h2>Oversampling with random, reasonable parameters<a class="headerlink" href="#oversampling-with-random-reasonable-parameters" title="Permalink to this headline">¶</a></h2>
<p>In order to facilitate model selection, each oversampler class is able to generate a set of reasonable parameter combinations. Running an oversampler using a reasonable parameter combination:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">smote_variants</span> <span class="kn">as</span> <span class="nn">sv</span>
<span class="kn">import</span> <span class="nn">imbalanced</span> <span class="nn">datasets</span> <span class="kn">as</span> <span class="nn">imbd</span>

<span class="n">dataset</span><span class="o">=</span> <span class="n">imbd</span><span class="o">.</span><span class="n">load_yeast1</span><span class="p">()</span>

<span class="n">par_combs</span><span class="o">=</span> <span class="n">SMOTE_Cosine</span><span class="o">.</span><span class="n">parameter_combinations</span><span class="p">()</span>

<span class="n">oversampler</span><span class="o">=</span> <span class="n">SMOTE_Cosine</span><span class="p">(</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">par_combs</span><span class="p">))</span>

<span class="n">X_samp</span><span class="p">,</span> <span class="n">y_samp</span><span class="o">=</span> <span class="n">oversampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="multiclass-oversampling">
<h2>Multiclass oversampling<a class="headerlink" href="#multiclass-oversampling" title="Permalink to this headline">¶</a></h2>
<p>Multiclass oversampling is highly ambiguous task, as balancing various classes might be optimal with various oversampling techniques. Currently, we have support for multiclass oversampling with one specific oversampler, and only those oversamplers can be used which do not change the majority class and have a <code class="docutils literal notranslate"><span class="pre">proportion</span></code> parameter to explicitly specify the number of samples to be generated. Suitable oversampling techniques can be queried by the <code class="docutils literal notranslate"><span class="pre">get_all_oversamplers_multiclass</span></code> function. In the below example the <code class="docutils literal notranslate"><span class="pre">wine</span></code> dataset is balanced by multiclass oversampling:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">smote_variants</span> <span class="kn">as</span> <span class="nn">sv</span>
<span class="kn">import</span> <span class="nn">sklearn.datasets</span> <span class="kn">as</span> <span class="nn">datasets</span>

<span class="n">dataset</span><span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_wine</span><span class="p">()</span>

<span class="n">oversampler</span><span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">MulticlassOversampling</span><span class="p">(</span><span class="n">sv</span><span class="o">.</span><span class="n">distance_SMOTE</span><span class="p">())</span>

<span class="n">X_samp</span><span class="p">,</span> <span class="n">y_samp</span><span class="o">=</span> <span class="n">oversampler</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="model-selection">
<h2>Model selection<a class="headerlink" href="#model-selection" title="Permalink to this headline">¶</a></h2>
<p>When facing an imbalanced dataset, model selection is crucial to find the right oversampling approach and the right classifier. It is obvious that the best performing oversampling technique depends on the subsequent classification, thus, the model selection of oversampler and classifier needs to be carried out hand in hand. This is facilitated by the <code class="docutils literal notranslate"><span class="pre">model_selection</span></code> function of the package. One must specify a set of oversamplers and a set of classifiers, a score function (in this case ‘AUC’) to optimize in cross validation and the <code class="docutils literal notranslate"><span class="pre">model_selection</span></code> function does all the job:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">smote_variants</span> <span class="kn">as</span> <span class="nn">sv</span>
<span class="kn">import</span> <span class="nn">imbalanced_datasets</span> <span class="kn">as</span> <span class="nn">imbd</span>

<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="n">datasets</span><span class="o">=</span> <span class="p">[</span><span class="n">imbd</span><span class="o">.</span><span class="n">load_glass2</span><span class="p">]</span>
<span class="n">oversamplers</span><span class="o">=</span> <span class="p">[</span><span class="n">sv</span><span class="o">.</span><span class="n">SMOTE_ENN</span><span class="p">,</span> <span class="n">sv</span><span class="o">.</span><span class="n">NEATER</span><span class="p">,</span> <span class="n">sv</span><span class="o">.</span><span class="n">Lee</span><span class="p">]</span>
<span class="n">classifiers</span><span class="o">=</span> <span class="p">[</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span> <span class="mi">3</span><span class="p">),</span>
                <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span> <span class="mi">5</span><span class="p">),</span>
                <span class="n">DecisionTreeClassifier</span><span class="p">()]</span>

<span class="n">cache_path</span><span class="o">=</span> <span class="s1">&#39;/home/&lt;user&gt;/smote_validation/&#39;</span>

<span class="n">sampler</span><span class="p">,</span> <span class="n">classifier</span><span class="o">=</span> <span class="n">model_selection</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span>
                                        <span class="n">oversamplers</span><span class="p">,</span>
                                        <span class="n">classifiers</span><span class="p">,</span>
                                        <span class="n">cache_path</span><span class="p">,</span>
                                        <span class="s1">&#39;auc&#39;</span><span class="p">,</span>
                                        <span class="n">n_jobs</span><span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                        <span class="n">max_n_sampler_parameters</span><span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>Note, that we have also supplied a cache path, it is used to store partial results, samplings and cross validation scores. The <code class="docutils literal notranslate"><span class="pre">n_jobs</span></code> parameter specifies the number of oversampling and classification jobs to be executed in parallel, and <a href="#id1"><span class="problematic" id="id2">``</span></a>max_n_sampler_parameters` specifies the maximum number of reasonable parameter combinations tested for each oversampler. The function call returns the best performing oversampling object and the corresponding, best performing classifier object, respecting the ‘glass2’ dataset.</p>
</div>
<div class="section" id="thorough-evaluation-involving-multiple-datasets">
<h2>Thorough evaluation involving multiple datasets<a class="headerlink" href="#thorough-evaluation-involving-multiple-datasets" title="Permalink to this headline">¶</a></h2>
<p>Another scenario is the comparison and evaluation of a new oversampler to conventional ones involving a set of imbalance datasets. This scenario is facilitated by the <code class="docutils literal notranslate"><span class="pre">evaluate_oversamplers</span></code> function, which is parameterized similarly to <code class="docutils literal notranslate"><span class="pre">model_selection</span></code>, but returns all the raw results of the numerous cross-validation scenarios (all datasets times (all oversamplers with <code class="docutils literal notranslate"><span class="pre">max_n_sampler_parameters</span></code> parameter combinations) times (all supplied classifiers)):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">smote_variants</span> <span class="kn">as</span> <span class="nn">sv</span>
<span class="kn">import</span> <span class="nn">imbalanced_datasets</span> <span class="kn">as</span> <span class="nn">imbd</span>

<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="n">datasets</span><span class="o">=</span> <span class="p">[</span><span class="n">imbd</span><span class="o">.</span><span class="n">load_glass2</span><span class="p">,</span> <span class="n">imbd</span><span class="o">.</span><span class="n">load_ecoli4</span><span class="p">]</span>
<span class="n">oversamplers</span><span class="o">=</span> <span class="p">[</span><span class="n">sv</span><span class="o">.</span><span class="n">SMOTE_ENN</span><span class="p">,</span> <span class="n">sv</span><span class="o">.</span><span class="n">NEATER</span><span class="p">,</span> <span class="n">sv</span><span class="o">.</span><span class="n">Lee</span><span class="p">]</span>
<span class="n">classifiers</span><span class="o">=</span> <span class="p">[</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span> <span class="mi">3</span><span class="p">),</span>
                <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span> <span class="mi">5</span><span class="p">),</span>
                <span class="n">DecisionTreeClassifier</span><span class="p">()]</span>

<span class="n">cache_path</span><span class="o">=</span> <span class="s1">&#39;/home/&lt;user&gt;/smote_validation/&#39;</span>

<span class="n">results</span><span class="o">=</span> <span class="n">evaluate_oversamplers</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span>
                                <span class="n">oversamplers</span><span class="p">,</span>
                                <span class="n">classifiers</span><span class="p">,</span>
                                <span class="n">cache_path</span><span class="p">,</span>
                                <span class="n">n_jobs</span><span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                <span class="n">max_n_sampler_parameters</span><span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Again, the function uses 10 parallel jobs to execute oversampling and classification. In the example above, 2 datasets, 3 classifiers and maximum 10 oversampler parameter combinations are specified for 3 oversampling objects, which requires 2x3x10x3 180 cross-validations altogether. In the resulting pandas DataFrame, for each classifier type (KNeighborsClassifier and DecisionTreeClassifier), and for each oversampler the highest performance measures and the corresponding classifier and oversampler parameters are returned. The structure of the DataFrame is self-explaining.</p>
</div>
<div class="section" id="reproducing-the-results-in-the-comparative-study">
<h2>Reproducing the results in the comparative study<a class="headerlink" href="#reproducing-the-results-in-the-comparative-study" title="Permalink to this headline">¶</a></h2>
<p>Although a 5-fold 3 times repeated stratified k-fold cross validation was executed, one might expect that the results still depend slightly on the foldings being used. In order to fully reproduce the results of the comparative study, download the foldings we use, and execute the following script by setting the cache_path to the path containing the downloaded foldings. The folding generator will pick-up and use the foldings supplied:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">pickle</span><span class="o">,</span> <span class="nn">itertools</span>

<span class="c1"># import classifiers</span>
<span class="kn">from</span> <span class="nn">sklearn.calibration</span> <span class="kn">import</span> <span class="n">CalibratedClassifierCV</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">smote_variants</span> <span class="kn">import</span> <span class="n">MLPClassifierWrapper</span>

<span class="c1"># import SMOTE variants</span>
<span class="kn">import</span> <span class="nn">smote_variants</span> <span class="kn">as</span> <span class="nn">sv</span>

<span class="c1"># itertools to derive imbalanced databases</span>
<span class="kn">import</span> <span class="nn">imbalanced_databases</span> <span class="kn">as</span> <span class="nn">imbd</span>

<span class="c1"># global variables</span>
<span class="n">folding_path</span><span class="o">=</span> <span class="s1">&#39;/home/&lt;user&gt;/smote_foldings/&#39;</span>
<span class="n">max_sampler_parameter_combinations</span><span class="o">=</span> <span class="mi">35</span>
<span class="n">n_jobs</span><span class="o">=</span> <span class="mi">5</span>

<span class="c1"># instantiate classifiers</span>
<span class="n">sv_classifiers</span><span class="o">=</span> <span class="p">[</span><span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span> <span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span> <span class="bp">False</span><span class="p">)),</span>
                <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span> <span class="s1">&#39;hinge&#39;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span> <span class="bp">True</span><span class="p">)),</span>
                <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span> <span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span> <span class="bp">False</span><span class="p">)),</span>
                <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span> <span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span> <span class="bp">False</span><span class="p">)),</span>
                <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span> <span class="s1">&#39;hinge&#39;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span> <span class="bp">True</span><span class="p">)),</span>
                <span class="n">CalibratedClassifierCV</span><span class="p">(</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span> <span class="s1">&#39;squared_hinge&#39;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span> <span class="bp">False</span><span class="p">))]</span>

<span class="n">mlp_classifiers</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;logistic&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]):</span>
    <span class="n">mlp_classifiers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MLPClassifierWrapper</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hidden_layer_fraction</span><span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">nn_classifiers</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]):</span>
    <span class="n">nn_classifiers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

<span class="n">dt_classifiers</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">],</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]):</span>
    <span class="n">dt_classifiers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">max_depth</span><span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">classifiers</span><span class="o">=</span> <span class="p">[]</span>
<span class="n">classifiers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sv_classifiers</span><span class="p">)</span>
<span class="n">classifiers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">mlp_classifiers</span><span class="p">)</span>
<span class="n">classifiers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">nn_classifiers</span><span class="p">)</span>
<span class="n">classifiers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">dt_classifiers</span><span class="p">)</span>

<span class="n">datasets</span><span class="o">=</span> <span class="n">imbd</span><span class="o">.</span><span class="n">get_data_loaders</span><span class="p">(</span><span class="s1">&#39;study&#39;</span><span class="p">)</span>

<span class="c1"># instantiate the validation object</span>
<span class="n">results</span><span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">evaluate_oversamplers</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span>
                                <span class="n">samplers</span><span class="o">=</span> <span class="n">sv</span><span class="o">.</span><span class="n">get_all_oversamplers</span><span class="p">(),</span>
                                <span class="n">classifiers</span><span class="o">=</span> <span class="n">classifiers</span><span class="p">,</span>
                                <span class="n">cache_path</span><span class="o">=</span> <span class="n">folding_path</span><span class="p">,</span>
                                <span class="n">n_jobs</span><span class="o">=</span> <span class="n">n_jobs</span><span class="p">,</span>
                                <span class="n">remove_sampling_cache</span><span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
                                <span class="n">max_n_sampler_parameters</span><span class="o">=</span> <span class="n">max_sampler_parameter_combinations</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="add_new_oversampler.html" class="btn btn-neutral float-right" title="Adding a new oversampler" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="multiclass_oversampling.html" class="btn btn-neutral" title="Multiclass oversampling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, György Kovács

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>